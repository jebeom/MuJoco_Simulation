{
    "sourceFile": "src/robotmodel.cpp",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 7,
            "patches": [
                {
                    "date": 1690510774601,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1690512905683,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -94,9 +94,9 @@\n \t\tRigidBodyDynamics::InverseDynamics(_model, _q, _zero_vec_joint, _zero_vec_joint, _g, NULL); // get _g\n \t\tRigidBodyDynamics::InverseDynamics(_model, _q, _qdot, _zero_vec_joint, _bg, NULL); // get _g+_b\n \t\t_b = _bg - _g; //get _b\n \n-\t\tcout << _g.transpose() <<endl;\n+\t\t\n \t}\n \telse\n \t{\n \t\tcout << \"Robot kinematics is not ready. Please update kinematics first.\" << endl << endl;\n"
                },
                {
                    "date": 1690786261054,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -17,9 +17,9 @@\n \t_bool_dynamics_update = false;\n \t_bool_Jacobian_update = false;\n \n     _k = JDOF;\n-    _id_hand = 7;\n+    _id_hand = 8;\n \n \t_max_joint_torque.setZero(_k);\n \t_min_joint_torque.setZero(_k);\n \t_max_joint_velocity.setZero(_k);\n"
                },
                {
                    "date": 1690786287851,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -17,9 +17,9 @@\n \t_bool_dynamics_update = false;\n \t_bool_Jacobian_update = false;\n \n     _k = JDOF;\n-    _id_hand = 8;\n+    _id_hand = 7;\n \n \t_max_joint_torque.setZero(_k);\n \t_min_joint_torque.setZero(_k);\n \t_max_joint_velocity.setZero(_k);\n"
                },
                {
                    "date": 1691113008458,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -170,14 +170,14 @@\n \t_max_joint_position(4) = 2.8973;\n \t_max_joint_position(5) = 3.7525;\n \t_max_joint_position(6) = 2.8973;\n \n-\t_max_joint_velocity(0) = 155.0 * DEG2RAD;\n-\t_max_joint_velocity(1) = 150.0 * DEG2RAD;\n-\t_max_joint_velocity(2) = 150.0 * DEG2RAD;\n-\t_max_joint_velocity(3) = 150.0 * DEG2RAD;\n-\t_max_joint_velocity(4) = 180.0 * DEG2RAD;\n-\t_max_joint_velocity(5) = 180.0 * DEG2RAD;\n-\t_max_joint_velocity(6) = 180.0 * DEG2RAD;\n+\t_max_joint_velocity(0) = 2.175;\n+\t_max_joint_velocity(1) = 2.175;\n+\t_max_joint_velocity(2) = 2.175;\n+\t_max_joint_velocity(3) = 2.175;\n+\t_max_joint_velocity(4) = 2.61;\n+\t_max_joint_velocity(5) = 2.61;\n+\t_max_joint_velocity(6) = 2.61;\n \t_min_joint_velocity = -_max_joint_velocity;\n \n }\n"
                },
                {
                    "date": 1691483136501,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -55,9 +55,9 @@\n \n void CModel::load_model()\n {   \n     // RigidBodyDynamics::Addons::URDFReadFromFile(\"../model/panda_arm_hand.urdf\", &_model, false, true);\n-\tRigidBodyDynamics::Addons::URDFReadFromFile(\"../model/fr3.urdf\", &_model, false, true);\n+\tRigidBodyDynamics::Addons::URDFReadFromFile(\"model/fr3.urdf\", &_model, false, true);\n \n     cout << endl << endl << \"Model Loaded for RBDL.\" << endl << \"Total DoFs: \" << _model.dof_count << endl << endl;\n \tif (_model.dof_count != _k)\n \t{\n"
                },
                {
                    "date": 1691569629792,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -55,9 +55,9 @@\n \n void CModel::load_model()\n {   \n     // RigidBodyDynamics::Addons::URDFReadFromFile(\"../model/panda_arm_hand.urdf\", &_model, false, true);\n-\tRigidBodyDynamics::Addons::URDFReadFromFile(\"model/fr3.urdf\", &_model, false, true);\n+\tRigidBodyDynamics::Addons::URDFReadFromFile(\"model/fr3.urdf\", &_model, false, false);\n \n     cout << endl << endl << \"Model Loaded for RBDL.\" << endl << \"Total DoFs: \" << _model.dof_count << endl << endl;\n \tif (_model.dof_count != _k)\n \t{\n"
                },
                {
                    "date": 1692684657859,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -55,9 +55,9 @@\n \n void CModel::load_model()\n {   \n     // RigidBodyDynamics::Addons::URDFReadFromFile(\"../model/panda_arm_hand.urdf\", &_model, false, true);\n-\tRigidBodyDynamics::Addons::URDFReadFromFile(\"model/fr3.urdf\", &_model, false, false);\n+\tRigidBodyDynamics::Addons::URDFReadFromFile(\"../model/fr3.urdf\", &_model, false, false);\n \n     cout << endl << endl << \"Model Loaded for RBDL.\" << endl << \"Total DoFs: \" << _model.dof_count << endl << endl;\n \tif (_model.dof_count != _k)\n \t{\n"
                }
            ],
            "date": 1690510774601,
            "name": "Commit-0",
            "content": "#include \"robotmodel.h\"\n#define JDOF 7\n\nCModel::CModel()\n{\n\tInitialize();\n}\n\nCModel::~CModel()\n{\n}\n\nvoid CModel::Initialize()\n{\n\t_bool_model_update = false;\n\t_bool_kinematics_update = false;\n\t_bool_dynamics_update = false;\n\t_bool_Jacobian_update = false;\n\n    _k = JDOF;\n    _id_hand = 7;\n\n\t_max_joint_torque.setZero(_k);\n\t_min_joint_torque.setZero(_k);\n\t_max_joint_velocity.setZero(_k);\n\t_min_joint_velocity.setZero(_k);\n\t_max_joint_position.setZero(_k);\n\t_min_joint_position.setZero(_k);\n\n    _q.setZero(_k);\n    _qdot.setZero(_k);\n    _zero_vec_joint.setZero(_k);\n\n    _A.setZero(_k,_k);\n    _g.setZero(_k);\n\t_b.setZero(_k);\n\t_bg.setZero(_k);\n\n    _J_hand.setZero(6,_k);\n    _J_tmp.setZero(6,_k);\n\n    _position_local_task_hand.setZero(); // 3x1\n\t_tmp_position_local_task_hand.setZero(); // 3x1\n\t// _tmp_position_local_task_hand(0) = 0.088;\n\n    _x_hand.setZero(); // 3x1\n    _R_hand.setZero(); // 3x3\n\n    _xdot_hand.setZero(6);\n\n\tset_robot_config();\n    load_model();\n}\n\n\nvoid CModel::load_model()\n{   \n    // RigidBodyDynamics::Addons::URDFReadFromFile(\"../model/panda_arm_hand.urdf\", &_model, false, true);\n\tRigidBodyDynamics::Addons::URDFReadFromFile(\"../model/fr3.urdf\", &_model, false, true);\n\n    cout << endl << endl << \"Model Loaded for RBDL.\" << endl << \"Total DoFs: \" << _model.dof_count << endl << endl;\n\tif (_model.dof_count != _k)\n\t{\n\t\tcout << \"Simulation model and RBDL model mismatch!!!\" << endl << endl;\n\t}\n\n    _bool_model_update = true; //check model update\n\n\tcout << \"Model Loading Complete.\" << endl << endl;\n\n}\n\nvoid CModel::update_kinematics(VectorXd & q, VectorXd & qdot)\n{\n\t_q = q;\n\t_qdot = qdot;\n\n\tif (_bool_model_update == true)\n\t{\n\t\tRigidBodyDynamics::UpdateKinematicsCustom(_model, &_q, &_qdot, NULL); // update kinematics\n\t}\n\telse\n\t{\n\t\tcout << \"Robot model is not ready. Please load model first.\" << endl << endl;\n\t}\n\t_bool_kinematics_update = true; // check kinematics update\n}\n\nvoid CModel::update_dynamics()\n{\n\tif (_bool_kinematics_update == true)\n\t{\t\n\t\tRigidBodyDynamics::CompositeRigidBodyAlgorithm(_model, _q, _A, false); // update inertia matrix\n\t\tRigidBodyDynamics::InverseDynamics(_model, _q, _zero_vec_joint, _zero_vec_joint, _g, NULL); // get _g\n\t\tRigidBodyDynamics::InverseDynamics(_model, _q, _qdot, _zero_vec_joint, _bg, NULL); // get _g+_b\n\t\t_b = _bg - _g; //get _b\n\n\t\tcout << _g.transpose() <<endl;\n\t}\n\telse\n\t{\n\t\tcout << \"Robot kinematics is not ready. Please update kinematics first.\" << endl << endl;\n\t}\n\t_bool_dynamics_update = true; // check kinematics update\n}\n\nvoid CModel::calculate_EE_Jacobians()\n{\n\tif (_bool_kinematics_update == true)\n\t{\n\t\t_J_hand.setZero();\n\t\t_J_tmp.setZero();\t\n\n\t\tRigidBodyDynamics::CalcPointJacobian6D(_model, _q, _id_hand, _tmp_position_local_task_hand, _J_tmp, false); // update kinematc : false\n\t\t_J_hand.block<3, 7>(0, 0) = _J_tmp.block<3, 7>(3, 0); // linear : last three entries -> first three entries\n\t\t_J_hand.block<3, 7>(3, 0) = _J_tmp.block<3, 7>(0, 0); // angular : first three entries -> last three entries\n\n\t\t_bool_Jacobian_update = true;\n\t}\n\telse\n\t{\n\t\tcout << \"Robot kinematics is not ready. Please update kinematics first.\" << endl << endl;\n\t}\n\n}\n\nvoid CModel::calculate_EE_positions_orientations()\n{\n    if (_bool_kinematics_update == true)\n\t{\n\t\t_x_hand.setZero();\n\t\t_R_hand.setZero();\n\n\t\t_x_hand = RigidBodyDynamics::CalcBodyToBaseCoordinates(_model, _q, _id_hand, _position_local_task_hand, false);\n\t\t_R_hand = RigidBodyDynamics::CalcBodyWorldOrientation(_model, _q, _id_hand, false).transpose();\n\n\t}\n\telse\n\t{\n\t\tcout << \"Robot kinematics is not ready. Please update kinematics first.\" << endl << endl;\n\t}\n}\n\nvoid CModel::calculate_EE_velocity()\n{\n\tif (_bool_Jacobian_update == true)\n\t{\n\t\t_xdot_hand = _J_hand * _qdot;\n\t}\n\telse\n\t{\n\t\tcout << \"Jacobian matrices are not ready. Please calculate Jacobians first.\" << endl << endl;\n\t}\n}\n\nvoid CModel::set_robot_config(){\n\t\n\t_min_joint_position(0) = -2.8973;\n\t_min_joint_position(1) = -1.7628;\n\t_min_joint_position(2) = -2.8973;\n\t_min_joint_position(3) = -3.0718;\n\t_min_joint_position(4) = -2.8973;\n\t_min_joint_position(5) = -0.0175;\n\t_min_joint_position(6) = -2.8973;\n\n\t_max_joint_position(0) = 2.8973;\n\t_max_joint_position(1) = 1.7628;\n\t_max_joint_position(2) = 2.8973;\n\t_max_joint_position(3) = -0.0698;\n\t_max_joint_position(4) = 2.8973;\n\t_max_joint_position(5) = 3.7525;\n\t_max_joint_position(6) = 2.8973;\n\n\t_max_joint_velocity(0) = 155.0 * DEG2RAD;\n\t_max_joint_velocity(1) = 150.0 * DEG2RAD;\n\t_max_joint_velocity(2) = 150.0 * DEG2RAD;\n\t_max_joint_velocity(3) = 150.0 * DEG2RAD;\n\t_max_joint_velocity(4) = 180.0 * DEG2RAD;\n\t_max_joint_velocity(5) = 180.0 * DEG2RAD;\n\t_max_joint_velocity(6) = 180.0 * DEG2RAD;\n\t_min_joint_velocity = -_max_joint_velocity;\n\n}\n"
        }
    ]
}